<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Setting up Travis CI Enterprise - Travis CI</title>
<link rel="stylesheet" href="/docs-travis-ci-cn/assets/stylesheets/main.css">
<link rel="alternate" type="application/rss+xml" title="Travis CI Build Environment Updates" href="https://docs.travis-ci.com/feed.build-env-updates.xml">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" defer></script>

<script src="/docs-travis-ci-cn/assets/javascripts/main.js" type="text/javascript" charset="utf-8" defer></script>
<script src="/docs-travis-ci-cn/assets/javascripts/prism.js" type="text/javascript" charset="utf-8" defer></script>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24868285-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </head>
  <body class="enterprise">
    <div class="wrapper">

      <header class="top">
  <div class="row topbar">
    <h1 id="logo" class="logo">
  <a href="https://travis-ci.com/" title="Travis CI">Travis</a>
</h1>

    <nav>
      <ul id="navigation" class="navigation">
        <li><a href="https://blog.travis-ci.com">Blog</a></li>
        <li><a href="/">Docs</a></li>
        <li class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></li>
      </ul>
    </nav>
  </div>
</header>


      <div id="content" class="row">

        <div id="sidebar" class="sidebar">
  <div>
    <!-- <h2>Search</h2> -->
    <div class="searchbox">
      <form>
        <input type="text" id="st-search-input" class="searchbox-input" placeholder="Search the docs" />
      </form>
      <script type="text/javascript">
      var Swiftype = window.Swiftype || {};
        (function() {
          Swiftype.key = 'tXvDDzd4fNTBnLvxfEyx';

      Swiftype.searchSearchFields = {
            "page": ["title, body, tags"]
          };
          Swiftype.autocompleteSearchFields = {
            "page": ["title, body, tags"]
          };
          /** DO NOT EDIT BELOW THIS LINE **/
          var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
          script.src = "//swiftype.com/embed.js";
          var entry = document.getElementsByTagName('script')[0];
          document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
        }());
      </script>
    </div>
  </div>

  <section class="sidebar-navigation">
    <nav>
      <h3>Travis CI Enterprise</h3>
      <ul>
        <li><a href="/docs-travis-ci-cn/user/enterprise/">About Travis CI Enterprise</a></li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/setting-up-travis-ci-enterprise/">Setting up Travis CI Enterprise</a> </li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/upgrading/">Upgrading</a></li>
      </ul>

      <h3>Environment reference</h3>
      <ul>
        <li><a href="/docs-travis-ci-cn/user/enterprise/xenial">Xenial Build Environment</a></li>

        <li><a href="/docs-travis-ci-cn/user/enterprise/trusty/">Trusty Build Environment</a></li>

        <li><a href="/docs-travis-ci-cn/user/enterprise/precise/">Precise (Legacy) Build Environment</a></li>
      </ul>

      <h3>Customizing Travis CI Enterprise</h3>
      <ul>
        <li><a href="/docs-travis-ci-cn/user/enterprise/worker-configuration/">Worker Configuration</a></li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/build-images/">Customizing Build Images</a></li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/high-availability/">High Availability</a></li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/custom-queues/">Custom Queues</a></li>
      </ul>

      <h3>Enterprise Operations Manual</h3>
      <ul>
        <li><a href="/docs-travis-ci-cn/user/enterprise/platform-tips/">Platform Administration Tips</a></li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/worker-cli-commands/">Worker Start & Debug Containers</a></li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/ssl-certificate-management/">SSL Certificate Management</a></li>
        <li><a href="/docs-travis-ci-cn/user/enterprise/troubleshooting-guide/">Troubleshooting Guide</a></li>
      </ul>

      <h3>Travis CI Docs</h3>
      <ul>
        <li><a href="/">Travis CI Docs</a></li>
      </ul>
    </nav>
  </section>

  <section class="sidebar-notice">
    <p>This documentation site is open source.
      The <a href="https://github.com/travis-ci/docs-travis-ci-com">README in our Git repository</a> explains how to contribute.</p>
  </section>

</div><!-- /#sidebar -->


        <main id="main" class="main" data-swiftype-index='true'>
          
            <aside class="improve-page"><a href="https://github.com/travis-ci/docs-travis-ci-com/edit/master/user/enterprise/setting-up-travis-ci-enterprise.md" target="_blank" title="Edit this page on GitHub" class="button-pen" data-proofer-ignore>Improve this page on GitHub</a></aside>
            <h1 class="title">Setting up Travis CI Enterprise</h1>
          

          
            <div id="toc" class="toc">
              <ul class="list-language">
  <li><a href="#先决条件">先决条件</a></li>
  <li><a href="#1设置enterprise-platform虚拟机">1.设置Enterprise Platform虚拟机</a></li>
  <li><a href="#3运行构建">3.运行构建！</a></li>
</ul>

            </div>
          

          <p>Travis CI Enterprise可与您的GitHub.com或GitHub Enterprise设置配合使用。</p>

<h2 id="先决条件">先决条件 <a href="#先决条件" class="toc-anchor">#</a></h2>

<ul>
  <li>有效的Travis CI Enterprise许可证或<a href="https://enterprise.travis-ci.com/signup">试用许可证</a>。如果您对使用感兴趣<a href="/user/enterprise/high-availability/">高可用性</a>，<a href="mailto:enterprise@travis-ci.com">请告诉我们</a>所以我们可以配置您的试用许可证。</li>
  <li>您的私有云上​​至少有两个虚拟机满足<a href="#system-requirements"></a></li>
  <li>该<code class="highlighter-rouge">secret</code><code class="highlighter-rouge">clientid</code><a href="https://developer.github.com/apps/building-integrations/setting-up-and-registering-oauth-apps/registering-oauth-apps/"></a>配置：
    <ul>
      <li>
        <ul>
          <li><code class="highlighter-rouge">https://&lt;your-travis-ci-enterprise-domain&gt;</code></li>
        </ul>
      </li>
      <li>
        <ul>
          <li><code class="highlighter-rouge">https://&lt;your-travis-ci-enterprise-domain&gt;/api</code></li>
        </ul>
      </li>
      <li></li>
    </ul>
  </li>
</ul>

<p>URL必须在开头包含https或http，并且不能包含尾部斜杠。</p>

<h3 id="系统要求">系统要求 <a href="#系统要求" class="toc-anchor">#</a></h3>

<p>标准设置包括Travis CI企业</p>

<p>平台</p>

<p>工人主持人使用LXC在隔离容器中运行测试/作业</p>

<p>和Docker。</p>

<p>应运行每个专用主机或虚拟机管理程序（VMWare，使用KVM的OpenStack或EC2）<strong>Ubuntu 16.04</strong>，理想情况下使用Linux 3.16并至少拥有<strong>16演出的RAM和8个CPU</strong>。</p>

<p>如果您在EC2上运行，我们建议您使用<strong>**两者的实例类型</strong>平台<strong>和</strong>工人**。我们还建议使用使用EBS作为根卷的图像，以及为其分配40 gig的空间。</p>

<p>对于<a href="/user/enterprise/high-availability/">高可用性（HA）</a>配置，您还需要：</p>

<ul>
  <li><a href="https://redis.io/">Redis的</a>，</li>
  <li><a href="https://www.rabbitmq.com/">的RabbitMQ</a></li>
  <li><a href="https://www.postgresql.org/">Postgres的</a></li>
</ul>

<p>您也可以尝试像这样的服务<a href="https://compose.com/">compose.com</a>如果您希望在您的组织外部托管这些服务。</p>

<h2 id="1设置enterprise-platform虚拟机">1.设置Enterprise Platform虚拟机 <a href="#1设置enterprise-platform虚拟机" class="toc-anchor">#</a></h2>

<p>Travis CI企业平台处理许可，协调工作人员</p>

<p>处理并维护企业用户和管理仪表板。肯定是</p>

<p>安装在它自己的机器实例上，与Travis CI分开</p>

<p>企业工人。我们建议使用AWS’<code class="highlighter-rouge">c4.2xlarge</code>实例运行</p>

<p>Ubuntu 16.04 LTS或更高版本作为底层操作系统。</p>

<ol>
  <li>在您的虚拟机管理平台上，创建一个Travis CI平台安全组。
如果您是第一次设置AMI，则需要创建</li>
</ol>

<p>安全组。从EC2管理控制台，为其创建条目</p>

<p>下表中的每个端口：
|港口|服务|说明|</p>

<table>
  <tbody>
    <tr>
      <td>—–</td>
      <td>：—————-</td>
      <td>：———————– ————————————————– —-</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>8800</td>
      <td>自定义TCP规则</td>
      <td>此端口用于访问Enterprise安装的管理仪表板。</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>5672</td>
      <td>自定义TCP规则</td>
      <td>对于RabbitMQ非SSL。</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>4567</td>
      <td>自定义TCP规则</td>
      <td>对于RabbitMQ SSL。</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>443</td>
      <td>HTTPS</td>
      <td>通过HTTPS访问的Web应用程序。</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>80</td>
      <td>HTTP</td>
      <td>Web应用程序访问。</td>
    </tr>
  </tbody>
</table>

<p>| 22 | SSH | SSH访问。 |</p>
<ol>
  <li>如果您使用的是主机名而不仅仅是IP地址，那么这是配置它的时间。</li>
  <li>，下载并运行安装脚本：
```
curl -sSL -o /tmp/installer.sh https://enterprise.travis-ci.com/install
sudo bash /tmp/installer.sh</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
4. 在您的浏览器中， 导航`https://&lt;your-travis-ci-enterprise-domain&gt;:8800`（你的企业

安装的主机名，端口8800）来完成设置：
   1. 添加安全证书或配置可信证书。
   2. 上传您的Travis CI Enterprise许可证。
   3. 使用密码或使用openLDAP配置对管理控制台的访问。这可以控制对管理控制台本身的访问，而不是对Travis CI Enterprise实例的访问。
   4. 将您的GitHub Enterprise或GitHub.com与Travis CI企业连接。
   5. （可选）配置电子邮件，度量标准和缓存。
   6. 复制


&gt;如果您决定使用自签名证书，则可能需要执行其他配置步骤。请参阅我们的页面[SSL证书管理](/user/enterprise/ssl-certificate-management)

## 2.设置Enterprise Worker虚拟机

Travis CI企业工作者管理构建容器和报告构建

状态回到平台。它必须安装在单独的机器上

来自平台的实例。我们建议使用AWS'`c4.2xlarge`实例运行Ubuntu 16.04 LTS或更高版本作为底层操作系统。

确保你已经[建立企业平台](/user/enterprise/setting-up-travis-ci-enterprise/#1-setting-up-enterprise-platform-virtual-machine)并拥有RabbitMQ密码和主机名来自平台仪表板。

1. 在您的虚拟机管理平台上，创建一个Travis CI工人安全组
如果您是第一次设置AMI，则需要创建

安全组。从EC2管理控制台，为其创建条目


|港口|服务|说明|

| ----- |：-------- |：------------ |

| 22 | SSH | SSH访问。 |
2. 在您的新虚拟机上，下载并运行安装脚本：
</code></pre></div></div>
<p>$ curl -sSL -o /tmp/installer.sh https://raw.githubusercontent.com/travis-ci/travis-enterprise-worker-installers/master/installer.sh
$ sudo bash /tmp/installer.sh –travis_enterprise_host=”<enterprise host="">" --travis_enterprise_security_token="<rabbitmq password="">"</rabbitmq></enterprise></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

### 在Web代理后面安装worker

如果您位于Web代理后面且Docker无法下载映像，则在运行工作线程安装脚本时，请进行编辑`/etc/default/docker`并在那里设置代理。

然后重新运行安装脚本。

如果您需要Docker本身来使用HTTP代理，请在每个docker命令之前将其导出：

</code></pre></div></div>
<p>export http_proxy=”http://proxy.mycompany.corp:8080/” docker <command /></p>

<p>```</p>

<h3 id="较旧版本的travis-ci-enterprise">较旧版本的Travis CI Enterprise <a href="#较旧版本的travis-ci-enterprise" class="toc-anchor">#</a></h3>

<table>
  <tbody>
    <tr>
      <td>：—————————–</td>
      <td>：—————– ————————————</td>
      <td>：———— —————————————–</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>企业2.2+</td>
      <td><a href="/user/enterprise/trusty/">信任（14.04）</a></td>
      <td><a href="/user/enterprise/precise/">精确（遗产，12.04）</a></td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>企业2.1.9+</td>
      <td><a href="/user/enterprise/precise/">精确（遗产，12.04）</a></td>
      <td><a href="/user/enterprise/trusty/"></a></td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>Enterprise 2.0+</td>
      <td><a href="/user/enterprise/precise/"></a></td>
      <td>-</td>
    </tr>
  </tbody>
</table>

<p>为工人设置新实例后，请按照<a href="/user/enterprise/trusty/">信任（14.04）</a>要么<a href="/user/enterprise/precise/">精确（遗产，12.04）</a>Travis CI Enterprise版本指南。</p>

<h2 id="3运行构建">3.运行构建！ <a href="#3运行构建" class="toc-anchor">#</a></h2>

<p><a href="https://docs.travis-ci.com/user/tutorial/">入门指南</a>并将一些存储库连接到您的新Travis CI安装程序！</p>

<!-- TODO

## 4. What next?

High Availability
Java config
Proxies

-->


        </main>
      </div><!-- /#content -->

      <footer class="footer">
  <div class="layout-inner">
    <div class="footer-elem">
      <svg width="142px" height="45.381px" viewBox="0 0 142 45.381" enable-background="new 0 0 142 45.381" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink= "http://www.w3.org/1999/xlink">
        <title>Travis CI Mascot</title>
        <image xlink:href="https://styleguide.travis-ci.com/images/logos/travis-footer-logo-new.svg" x="0" y="0" width="142px" height="45.381px" />
      </svg>
    </div>

    <div class="footer-elem"></div>

    <div class="footer-elem">
      <h3 class="footer-title">©Travis CI, GmbH</h3>
      <address>Rigaer Straße 8<br>10247 Berlin, Germany</address>
      <ul>
        <li><a href="https://travisci.workable.com/" title="Jobs at Travis CI">Work with Travis CI</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Help</h3>
      <ul>
        <li><a href="https://docs.travis-ci.com" title="Travis CI Docs">Documentation</a></li>
        <li><a href="https://changelog.travis-ci.com/">Changelog</a></li>
        <li><a href="https://blog.travis-ci.com/" title="Travis CI Blog">Blog</a></li>
        <li><a href="mailto:support@travis-ci.com" title="Email Travis CI support">Email</a></li>
        <li><a href="https://twitter.com/travisci" title="Travis CI on Twitter">Twitter</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Legal</h3>
      <ul>
        <li><a href="/docs-travis-ci-cn/imprint.html" title="Imprint">Imprint</a></li>
        <li><a href="/docs-travis-ci-cn/legal/terms-of-service/">Terms of Service</a></li>
        <li><a href="/docs-travis-ci-cn/legal/refund-policy/">Refund Policy</a></li>
        <li><a href="/docs-travis-ci-cn/legal/data-processing-agreement">Data Processing Agreement</a></li>
        <li><a href="/docs-travis-ci-cn/legal/privacy-policy/">Privacy Policy</a></li>
        <li><a href="/docs-travis-ci-cn/legal/privacy-shield-framework/">Privacy Shield Framework</a></li>
        <li><a href="/docs-travis-ci-cn/legal/security/">Security Statement</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Travis CI Status</h3>
      <ul>
        <li><div class="status-circle status">Status:</div>
          <a href="http://www.traviscistatus.com/">Travis CI Status</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

<script>
 fetch('https://pnpcptp8xh9k.statuspage.io/api/v2/status.json').then(function(response) {
   return response.json();
 }).then(function(data) {
   if (data.status && data.status.indicator) {
     document.querySelector('.status-circle').classList.add(data.status.indicator);
   }
 });
</script>

    </div><!-- /.wrapper -->
  </body>
</html>
