<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Trusty Build Containers for Enterprise - Travis CI</title>
<link rel="stylesheet" href="/docs-travis-ci-cn/assets/stylesheets/main.css">
<link rel="alternate" type="application/rss+xml" title="Travis CI Build Environment Updates" href="https://docs.travis-ci.com/feed.build-env-updates.xml">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" defer></script>

<script src="/docs-travis-ci-cn/assets/javascripts/main.js" type="text/javascript" charset="utf-8" defer></script>
<script src="/docs-travis-ci-cn/assets/javascripts/prism.js" type="text/javascript" charset="utf-8" defer></script>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24868285-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

  </head>
  <body class="enterprise">
    <div class="wrapper">

      <header class="top">
  <div class="row topbar">
    <h1 id="logo" class="logo">
  <a href="https://travis-ci.com/" title="Travis CI">Travis</a>
</h1>

    <nav>
      <ul id="navigation" class="navigation">
        <li><a href="https://blog.travis-ci.com">Blog</a></li>
        <li><a href="/">Docs</a></li>
        <li class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></li>
      </ul>
    </nav>
  </div>
</header>


      <div id="content" class="row">

        <div id="sidebar" class="sidebar">
  <div>
    <!-- <h2>Search</h2> -->
    <div class="searchbox">
      <form>
        <input type="text" id="st-search-input" class="searchbox-input" placeholder="Search the docs" />
      </form>
      <script type="text/javascript">
      var Swiftype = window.Swiftype || {};
        (function() {
          Swiftype.key = 'tXvDDzd4fNTBnLvxfEyx';

      Swiftype.searchSearchFields = {
            "page": ["title, body, tags"]
          };
          Swiftype.autocompleteSearchFields = {
            "page": ["title, body, tags"]
          };
          /** DO NOT EDIT BELOW THIS LINE **/
          var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
          script.src = "//swiftype.com/embed.js";
          var entry = document.getElementsByTagName('script')[0];
          document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
        }());
      </script>
    </div>
  </div>

  <section class="sidebar-navigation">
    <nav>
      <h3>Travis CI Enterprise</h3>
      <ul>
        <li><a href="/user/enterprise/">About Travis CI Enterprise</a></li>
        <li><a href="/user/enterprise/setting-up-travis-ci-enterprise/">Setting up Travis CI Enterprise</a> </li>
        <li><a href="/user/enterprise/upgrading/">Upgrading</a></li>
      </ul>

      <h3>Environment reference</h3>
      <ul>
        <li><a href="/user/enterprise/xenial">Xenial Build Environment</a></li>

        <li><a href="/user/enterprise/trusty/">Trusty Build Environment</a></li>

        <li><a href="/user/enterprise/precise/">Precise (Legacy) Build Environment</a></li>
      </ul>

      <h3>Customizing Travis CI Enterprise</h3>
      <ul>
        <li><a href="/user/enterprise/worker-configuration/">Worker Configuration</a></li>
        <li><a href="/user/enterprise/build-images/">Customizing Build Images</a></li>
        <li><a href="/user/enterprise/high-availability/">High Availability</a></li>
        <li><a href="/user/enterprise/custom-queues/">Custom Queues</a></li>
      </ul>

      <h3>Enterprise Operations Manual</h3>
      <ul>
        <li><a href="/user/enterprise/platform-tips/">Platform Administration Tips</a></li>
        <li><a href="/user/enterprise/worker-cli-commands/">Worker Start & Debug Containers</a></li>
        <li><a href="/user/enterprise/ssl-certificate-management/">SSL Certificate Management</a></li>
        <li><a href="/user/enterprise/troubleshooting-guide/">Troubleshooting Guide</a></li>
      </ul>

      <h3>Travis CI Docs</h3>
      <ul>
        <li><a href="/">Travis CI Docs</a></li>
      </ul>
    </nav>
  </section>

  <section class="sidebar-notice">
    <p>This documentation site is open source.
      The <a href="https://github.com/travis-ci/docs-travis-ci-com">README in our Git repository</a> explains how to contribute.</p>
  </section>

</div><!-- /#sidebar -->


        <main id="main" class="main" data-swiftype-index='true'>
          
            <aside class="improve-page"><a href="https://github.com/travis-ci/docs-travis-ci-com/edit/master/user/enterprise/trusty.md" target="_blank" title="Edit this page on GitHub" class="button-pen" data-proofer-ignore>Improve this page on GitHub</a></aside>
            <h1 class="title">Trusty Build Containers for Enterprise</h1>
          

          
            <div id="toc" class="toc">
              <ul class="list-language">
  <li><a href="#系统设置">系统设置</a></li>
  <li><a href="#使用travis-ci-enterprise-22进行安装">使用Travis CI Enterprise 2.2+进行安装</a></li>
  <li><a href="#使用travis-ci-enterprise-219进行安装">使用Travis CI Enterprise 2.1.9+进行安装</a></li>
  <li><a href="#重新启动travis-worker">重新启动<code class="highlighter-rouge">travis-worker</code></a></li>
</ul>

            </div>
          

          <h2 id="系统设置">系统设置 <a href="#系统设置" class="toc-anchor">#</a></h2>

<p><em>**</em>：要使用Trusty构建容器，Travis CI安装必须为2.1.9或更高版本。请务必<a href="/user/enterprise/upgrading/"></a>如果需要，在开始之前。</p>

r />

<blockquote>
  <p>精确构建容器和Trusty构建容器必须位于不同的实例上</p>
</blockquote>

<h2 id="使用travis-ci-enterprise-22进行安装">使用Travis CI Enterprise 2.2+进行安装 <a href="#使用travis-ci-enterprise-22进行安装" class="toc-anchor">#</a></h2>

<p>一旦工作器实例启动并运行，<code class="highlighter-rouge">travis-worker</code>可以按如下方式安装：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -sSL -o /tmp/installer.sh https://raw.githubusercontent.com/travis-ci/travis-enterprise-worker-installers/master/installer.sh

sudo bash /tmp/installer.sh \
--travis_enterprise_host="[travis.yourhost.com]" \
--travis_enterprise_security_token="[RabbitMQ Password/Enterprise Security Token]"

</code></pre></div></div>

<p>此安装程序使用Docker<code class="highlighter-rouge">aufs</code></p>

<h2 id="使用travis-ci-enterprise-219进行安装">使用Travis CI Enterprise 2.1.9+进行安装 <a href="#使用travis-ci-enterprise-219进行安装" class="toc-anchor">#</a></h2>

<p><a href="/user/enterprise/precise">精确[遗产]</a>因为它是默认工人。但是，从版本2.1.9+开始，可以使用Trusty构建环境，假设已设置功能标记。否则，安装过程与Enterprise 2.2系列非常相似。</p>

<p>###</p>

<ol>
  <li>SSH进入平台机器</li>
  <li>跑<code class="highlighter-rouge">travis console</code></li>
  <li>然后跑<code class="highlighter-rouge">Travis::Features.enable_for_all(:template_selection); Travis::Features.enable_for_all(:multi_os)</code></li>
  <li>输入<code class="highlighter-rouge">exit</code></li>
  <li>断开与Travis Enterprise平台机器的连接</li>
</ol>

<h3 id="安装travis-ci-enterprise-219">安装（Travis CI Enterprise 2.1.9+） <a href="#安装travis-ci-enterprise-219" class="toc-anchor">#</a></h3>

<p>一旦工作器实例启动并运行，<code class="highlighter-rouge">travis-worker</code>可以按如下方式安装：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -sSL -o /tmp/installer.sh https://raw.githubusercontent.com/travis-ci/travis-enterprise-worker-installers/master/installer.sh

sudo bash /tmp/installer.sh \
--travis_enterprise_host="[travis.yourhost.com]" \
--travis_enterprise_security_token="[RabbitMQ Password/Enterprise Security Token]"

</code></pre></div></div>

<p><code class="highlighter-rouge">aufs</code>存储驱动程序如果您有任何问题或疑虑，请[与我们联系]（mailto：enterprise@travis-ci.com?subject=Precise%20Workers）讨论替代方案。</p>

<h3 id="在travis-ci-enterprise-219上运行trusty构建">在Travis CI Enterprise 2.1.9+上运行Trusty构建 <a href="#在travis-ci-enterprise-219上运行trusty构建" class="toc-anchor">#</a></h3>

<p>要在具有Trusty映像的worker上运行构建，请添加<code class="highlighter-rouge">dist: trusty</code>到你的<code class="highlighter-rouge">.travis.yml</code>。如果您的项目中没有该密钥<code class="highlighter-rouge">.travis.yml</code>，构建将路由到默认（精确）构建环境。</p>

<h2 id="重新启动travis-worker">重新启动<code class="highlighter-rouge">travis-worker</code> <a href="#重新启动travis-worker" class="toc-anchor">#</a></h2>

<p>安装后，或者对工作程序应用配置更改时，请按如下方式重新启动工作程序：</p>

<p><code class="highlighter-rouge">sudo service travis-worker restart</code></p>

<p>在启动时应用工作程序配置更改。</p>

<p>##</p>

<p>To get in touch with us, please write a message to 
<a href="mailto:enterprise@travis-ci.com">enterprise@travis-ci.com</a>. If possible, 
please include as much of the following as you can:</p>

<ul>
  <li>Description of the problem - what are you observing?</li>
  <li>Which steps did you try already?</li>
  <li>A support bundle (You can get it from <code class="highlighter-rouge">https://&lt;your-travis-ci-enterprise-domain&gt;:8800/support</code>)</li>
  <li>Log files from all workers (They can be found at <code class="highlighter-rouge">/var/log/upstart/travis-worker.log</code> - please include as many as you can retrieve).</li>
  <li>If a build failed or errored, a text file of the build log</li>
</ul>

<p>Have you made any customizations to your setup? While we may be able to see some 
information (such as hostname, IaaS provider, and license expiration), there 
are many other things we can’t see which could lead to something not working. 
Therefore , we’d like to ask you to also answer the questions below in your 
support request (if applicable):</p>

<ul>
  <li>How many machines are you using?</li>
  <li>Do you use configuration management tools (Chef, Puppet)?</li>
  <li>Which other services do interface with Travis CI Enterprise?</li>
  <li>Do you use Travis CI Enterprise together with github.com or GitHub Enterprise?</li>
  <li>If you’re using GitHub Enterprise, which version of it?</li>
</ul>

<p>We’re looking forward to helping!</p>


        </main>
      </div><!-- /#content -->

      <footer class="footer">
  <div class="layout-inner">
    <div class="footer-elem">
      <svg width="142px" height="45.381px" viewBox="0 0 142 45.381" enable-background="new 0 0 142 45.381" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink= "http://www.w3.org/1999/xlink">
        <title>Travis CI Mascot</title>
        <image xlink:href="https://styleguide.travis-ci.com/images/logos/travis-footer-logo-new.svg" x="0" y="0" width="142px" height="45.381px" />
      </svg>
    </div>

    <div class="footer-elem"></div>

    <div class="footer-elem">
      <h3 class="footer-title">©Travis CI, GmbH</h3>
      <address>Rigaer Straße 8<br>10247 Berlin, Germany</address>
      <ul>
        <li><a href="https://travisci.workable.com/" title="Jobs at Travis CI">Work with Travis CI</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Help</h3>
      <ul>
        <li><a href="https://docs.travis-ci.com" title="Travis CI Docs">Documentation</a></li>
        <li><a href="https://changelog.travis-ci.com/">Changelog</a></li>
        <li><a href="https://blog.travis-ci.com/" title="Travis CI Blog">Blog</a></li>
        <li><a href="mailto:support@travis-ci.com" title="Email Travis CI support">Email</a></li>
        <li><a href="https://twitter.com/travisci" title="Travis CI on Twitter">Twitter</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Legal</h3>
      <ul>
        <li><a href="/imprint.html" title="Imprint">Imprint</a></li>
        <li><a href="/legal/terms-of-service/">Terms of Service</a></li>
        <li><a href="/legal/refund-policy/">Refund Policy</a></li>
        <li><a href="/legal/data-processing-agreement">Data Processing Agreement</a></li>
        <li><a href="/legal/privacy-policy/">Privacy Policy</a></li>
        <li><a href="/legal/privacy-shield-framework/">Privacy Shield Framework</a></li>
        <li><a href="/legal/security/">Security Statement</a></li>
      </ul>
    </div>

    <div class="footer-elem">
      <h3 class="footer-title">Travis CI Status</h3>
      <ul>
        <li><div class="status-circle status">Status:</div>
          <a href="http://www.traviscistatus.com/">Travis CI Status</a>
        </li>
      </ul>
    </div>
  </div>
</footer>

<script>
 fetch('https://pnpcptp8xh9k.statuspage.io/api/v2/status.json').then(function(response) {
   return response.json();
 }).then(function(data) {
   if (data.status && data.status.indicator) {
     document.querySelector('.status-circle').classList.add(data.status.indicator);
   }
 });
</script>

    </div><!-- /.wrapper -->
  </body>
</html>
